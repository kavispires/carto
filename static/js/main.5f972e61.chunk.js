(window.webpackJsonpcarto=window.webpackJsonpcarto||[]).push([[0],{13:function(e,t,a){e.exports=a(21)},18:function(e,t,a){},21:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(7),o=a.n(s),c=(a(18),a(2)),l=a(3),i=a(8),u=a(9),m=a(12),d=a(10),p=a(1),b=a(11),f=a(5),h=a.n(f),y={EXPLORE_CARDS:[{number:5,name:"Temple Ruins",type:"ruin",duration:0},{number:6,name:"Outpost Ruins",type:"ruin",duration:0},{number:7,name:"Great River",type:"explore",duration:1},{number:8,name:"Farmland",type:"explore",duration:1},{number:9,name:"Hamlet",type:"explore",duration:1},{number:10,name:"Forgotten Forest",type:"explore",duration:1},{number:11,name:"Hinterland Stream",type:"explore",duration:2},{number:12,name:"Homestead",type:"explore",duration:2},{number:13,name:"Orchard",type:"explore",duration:2},{number:14,name:"Treetop Village",type:"explore",duration:2},{number:15,name:"Marshlands",type:"explore",duration:2},{number:16,name:"Fishing Village",type:"explore",duration:2},{number:17,name:"Rift Lands",type:"explore",duration:0}],AMBUSH_CARDS:[{number:1,name:"Goblin Attack",type:"ambush",duration:0},{number:2,name:"Bugbear Assault",type:"ambush",duration:0},{number:3,name:"Kobold Onslaught",type:"ambush",duration:0},{number:4,name:"Gnoll Raid",type:"ambush",duration:0}],SEASON_CARDS:[{number:18,name:"Spring",scores:["A","B"],duration:8},{number:19,name:"Summer",scores:["B","C"],duration:8},{number:20,name:"Fall",scores:["C","D"],duration:7},{number:21,name:"Winter",scores:["D","A"],duration:6}],GOAL_CARDS:[{number:26,name:"Sentinel Wood",type:"forests",effect:"1 point for each forest space adjacent to the edge of the map"},{number:27,name:"Greenbough",type:"forests",effect:"1 point per column or row with at least one forest space (both column and row score)"},{number:28,name:"Treetower",type:"forests",effect:"1 point per forest space with all four sides surrounded by filled spaces"},{number:29,name:"Sentinel Wood",type:"forests",effect:"3 points for each mountain connected by a cluster of forest spaces"},{number:30,name:"Canal Lake",type:"farmlands",effect:"1 point per water space adjacent to a farm space.\n 1 point per farm space adjacent to a water space"},{number:31,name:"Mages Valley",type:"farmlands",effect:"2 points per water space adjacent to a mountain.\n 1 point per farm space adjacent to a mountain."},{number:32,name:"The Golden Granary",type:"farmlands",effect:"1 point per water space adjacent to a ruin space.\n 3 points per farm space on a ruin space"},{number:33,name:"Shoreside Expanse",type:"farmlands",effect:"3 points per cluster of farm not adjacent to water spaces or the edge of the map.\n 3 points per cluster of water not adjacent to farm spaces or the edge of the map"},{number:34,name:"Wildholds",type:"villages",effect:"8 points per cluster of 6 or more village spaces"},{number:35,name:"Great City",type:"villages",effect:"1 point per village space in your largest village cluster that is not adjacent to mountain spaces"},{number:36,name:"Greengold Plains",type:"villages",effect:"3 points for each cluster of village spaces that is adjacent to three or more different terrain types"},{number:37,name:"Shieldgate",type:"villages",effect:"2 points per village space in your second largest village cluster"},{number:38,name:"Borderlands",type:"territory",effect:"6 points per each completely filled row or column"},{number:39,name:"Last Barony",type:"territory",effect:"3 points for each column in your largest square of filled spaces"},{number:40,name:"The Broken Road",type:"territory",effect:"3 points for each diagonal line of filled spaces that touches that left and bottom edges of the map"},{number:41,name:"The Cauldrons",type:"territory",effect:"1 point per empty space surrounded on all four sides by filled spaces or the edge of the map"}],LETTER_CARDS:[{number:22,letter:"A"},{number:23,letter:"B"},{number:24,letter:"C"},{number:25,letter:"D"}]},v=function(e){var t=e.menuAction,a=e.children,n=e.isGoalsReady;return r.a.createElement("div",{className:"container"},r.a.createElement("nav",{className:"menu",onClick:t},r.a.createElement("button",{className:"btn-menu",id:"goals"},"Goals"),n&&r.a.createElement("button",{className:"btn-menu",id:"game"},"Game"),r.a.createElement("button",{className:"btn-menu btn-menu--left",id:"reset"},"Reset")),a)},g=a(4),E=function(e){var t=e.id,a=e.className,n=e.prefix,s=void 0===n?"card_":n,o="number"===typeof t&&t<10?"0".concat(t):t;return r.a.createElement("img",{className:a||"card",src:"".concat("/carto","/images/").concat(s).concat(o,".jpg"),alt:t})},C={farmlands:"farmlands",forests:"forest",territory:"territory",villages:"village"},S=function(e){var t=e.goalType,a=e.isGoalsReady,n=e.letterCard,s=e.selectGoalCard,o=e.selectedGoalCard,c=e.selectRandomGoalCard;return r.a.createElement("div",{className:"goal-options"},Boolean(o)?r.a.createElement("div",{className:"card-container"},r.a.createElement(E,{id:n.number,className:"card-mini"}),r.a.createElement(E,{id:C[t],className:"card-icon card-icon--selected",prefix:"icon-"}),r.a.createElement(E,{id:o.number})):r.a.createElement(E,{id:n.number}),r.a.createElement("div",{className:"select"},r.a.createElement("select",{onChange:function(e){return s(e.target.value,n.letter)},defaultValue:""},r.a.createElement("option",{value:"",disabled:!0},"Select a Goal"),y.GOAL_CARDS.map(function(e){return r.a.createElement("option",{key:e.number,value:e.number,disabled:t&&e.type!==t},e.name," (",e.type,")")})),r.a.createElement("div",{className:"select-arrow"})),r.a.createElement("button",{className:"btn btn--secondary btn--wide",onClick:function(){return c(n.letter)},disabled:a},"Random"))},O=function(e){var t=e.selectGoalCard,a=e.selectRandomGoalCard,n=e.state,s=e.switchTabs;return r.a.createElement("main",null,r.a.createElement("h1",{className:"title"},"Select Goals"),r.a.createElement("ul",{className:"goals-selection"},Object.entries(n.goals).map(function(e,s){var o=Object(g.a)(e,2),c=o[0],l=(o[1],y.LETTER_CARDS[s]);return r.a.createElement(S,{key:c,letterCard:l,selectGoalCard:t,selectedGoalCard:n.goals[l.letter],goalType:n.goalsType[l.letter],selectRandomGoalCard:a,isGoalsReady:n.isGoalsReady})})),r.a.createElement("footer",null,r.a.createElement("button",{className:"btn btn--primary",onClick:function(){return s("game")},disabled:!n.isGoalsReady},"Confirm")))},x=function(e){var t=e.previousCard.number||0;return r.a.createElement("div",{className:"explore-card explore-card--previous"},r.a.createElement(E,{id:t,className:"card card--faded-left"}))},j=function(e){var t=e.currentCard,a=e.previousCard;return r.a.createElement("div",{className:"explore-card explore-card--current"},"ruin"===a.type?r.a.createElement(E,{id:a.number,className:"card-mini card-mini--ruin"}):null,r.a.createElement(E,{id:t.number}))},k=function(e){var t=e.currentCard;return r.a.createElement("div",{className:"explore-card explore-card--next"},r.a.createElement(E,{id:0,className:"card card--faded-right"}),r.a.createElement(E,{id:t.number+1,className:"invisible"}))},G=function(e){var t=e.state,a=e.nextTurn,n=t.currentSeason,s=t.currentDuration,o=t.currentCard,c=t.previousCard,l=n.duration-s;return r.a.createElement("main",null,r.a.createElement("h1",{className:"title"},r.a.createElement(E,{id:"season",className:"card-icon card-icon--inline-title",prefix:"icon-"}),n.name),r.a.createElement("h2",{className:"subtitle"},"Time remaining: ",l>-1?l:0),r.a.createElement("section",{className:"playarea"},r.a.createElement(x,{previousCard:c}),r.a.createElement(j,{currentCard:o,previousCard:c}),r.a.createElement(k,{currentCard:o})),r.a.createElement("footer",null,r.a.createElement("button",{className:"btn btn--primary",onClick:function(){return a()}},l>0?"Next Turn":"Score Season")))},N=function(e){var t=e.state,a=e.startSeason,n=t.currentSeason,s=t.goals;return n.number?r.a.createElement("main",null,r.a.createElement("h1",{className:"title"},r.a.createElement(E,{id:"season",className:"card-icon card-icon--inline-title",prefix:"icon-"}),"Next Season: ",n.name),r.a.createElement("h2",{className:"subtitle"},"Duration: ",n.duration," | Scoring:"," ",n.scores.join(" & ")),r.a.createElement("section",{className:"seasonarea"},Object.entries(s).map(function(e){var t=Object(g.a)(e,2),a=t[0],s=t[1],o=n.scores.includes(a)?"scoring-card--active":"";return r.a.createElement("div",{key:"scoring-card-".concat(s.number),className:"scoring-card ".concat(o)},r.a.createElement(E,{id:s.number}),r.a.createElement("p",{className:"card-description"},s.effect))})),r.a.createElement("footer",null,r.a.createElement("button",{className:"btn btn--primary",onClick:function(){return a()}},"Begin Season"))):r.a.createElement("div",null)},A=function(e){var t=e.state,a=e.nextTurn,n=t.currentSeason,s=t.goals;return n.number?r.a.createElement("main",null,r.a.createElement("h1",{className:"title"},r.a.createElement(E,{id:"season",className:"card-icon card-icon--inline-title",prefix:"icon-"}),"Scoring Season: ",n.name),r.a.createElement("h2",{className:"subtitle"},"Scoring: ",n.scores.join(" & ")),r.a.createElement("section",{className:"seasonarea"},n.scores.map(function(e){var t=s[e];return r.a.createElement("div",{key:"scoring-card-".concat(t.number),className:"scoring-card scoring-card--scoring"},r.a.createElement(E,{id:t.number}),r.a.createElement("p",{className:"card-description"},t.effect))})),r.a.createElement("footer",null,"Winter"!==n.name?r.a.createElement("button",{className:"btn btn--primary",onClick:function(){return a()}},"Go to Next Season"):null)):r.a.createElement("div",null)};function R(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function w(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?R(a,!0).forEach(function(t){Object(l.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):R(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var T={tab:"goals",phase:"season",goals:{A:null,B:null,C:null,D:null},goalsType:{A:null,B:null,C:null,D:null},isGoalsReady:!1,isGameActive:!1,deck:[],ambushDeck:[],seasons:[],round:0,deckIndex:-1,currentSeason:{},currentDuration:0,currentCard:{},previousCard:{},usedAmbushIndexes:[]},D=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(m.a)(this,Object(d.a)(t).call(this))).state=Object.assign({},T),e.switchTabs=e.switchTabs.bind(Object(p.a)(e)),e.selectGoalCard=e.selectGoalCard.bind(Object(p.a)(e)),e.selectRandomGoalCard=e.selectRandomGoalCard.bind(Object(p.a)(e)),e.setupSeason=e.setupSeason.bind(Object(p.a)(e)),e.startSeason=e.startSeason.bind(Object(p.a)(e)),e.nextTurn=e.nextTurn.bind(Object(p.a)(e)),e}return Object(b.a)(t,e),Object(u.a)(t,[{key:"componentDidUpdate",value:function(e,t){"game"!==this.state.tab||this.state.tab===t.tab||this.state.isGameActive||this.setup()}},{key:"switchTabs",value:function(e){var t="string"===typeof e?e:e.target.id;"reset"===t?this.reset():t&&this.state.tab!==t&&this.setState({tab:t})}},{key:"reset",value:function(){this.setState(w({},T))}},{key:"selectGoalCard",value:function(e,t){var a=h.a.find(y.GOAL_CARDS,function(t){return t.number===+e}),n=w({},this.state.goals,Object(l.a)({},t,a)),r=Object.values(n).reduce(function(e,t){return null!==t&&e},!0),s=w({},this.state.goalsType,Object(l.a)({},t,a.type));this.setState({goals:n,goalsType:s,isGoalsReady:r})}},{key:"selectRandomGoalCard",value:function(e){for(var t=Object.values(w({},this.state.goalsType,Object(l.a)({},e,null))).reduce(function(e,t){return t&&(e[t]=!0),e},{}),a=null;!a;)t[(a=y.GOAL_CARDS[Math.floor(Math.random()*y.GOAL_CARDS.length)]).type]&&(a=null);this.selectGoalCard(a.number,e)}},{key:"setup",value:function(){var e=this;this.setState({isGameActive:!0,deck:Object(c.a)(y.EXPLORE_CARDS),ambushDeck:this.shuffleDeck(Object(c.a)(y.AMBUSH_CARDS)),seasons:Object(c.a)(y.SEASON_CARDS)}),setTimeout(function(){e.setupSeason()},500)}},{key:"setupSeason",value:function(){var e=this.state.round+1,t=Object(c.a)(this.state.ambushDeck),a=t.pop(),n=Object(c.a)(this.state.deck);n.push(a),this.state.usedAmbushIndexes.length>0&&h.a.pullAt(n,this.state.usedAmbushIndexes),n=this.shuffleDeck(n);var r=w({},y.SEASON_CARDS[e-1]);this.setState({phase:"season",round:e,deckIndex:-1,ambushDeck:t,deck:n,currentSeason:r,previousCard:{},currentDuration:0,currentCard:{},usedAmbushIndexes:[]})}},{key:"startSeason",value:function(){var e=this;this.setState({phase:"explore"}),setTimeout(function(){e.nextTurn()},500)}},{key:"nextTurn",value:function(){this.state.currentDuration>=this.state.currentSeason.duration&&"explore"===this.state.phase?this.scorePhase():this.explorePhase()}},{key:"explorePhase",value:function(){for(var e=this,t=this.state.deckIndex+1,a=this.state.deck[t],n=t>0?this.state.deck[t-1]:{},r=0,s=0;s<=t;s++)r+=this.state.deck[s].duration;var o={deckIndex:t,currentDuration:r,currentCard:a,previousCard:n};if("explore"!==this.state.phase&&(o.phase="explore"),"ambush"===a.type){var l=Object(c.a)(this.state.usedAmbushIndexes);l.push(t),o.usedAmbushIndexes=l}this.setState(o),"ruin"===a.type&&setTimeout(function(){e.explorePhase()},500)}},{key:"scorePhase",value:function(){this.setState({phase:"scoring"})}},{key:"shuffleDeck",value:function(e){for(var t=Object(c.a)(e.sort(function(){return Math.random()-.5})),a={5:!0,6:!0},n={1:!0,2:!0,3:!0,4:!0},r=!1;!r;){r=!0;for(var s=0;s<t.length;s++){var o=t[s];if(a[(t[s-1]||{}).number]&&n[o.number]){r=!1;var l=[t[s],t[s-1]];t[s-1]=l[0],t[s]=l[1]}}}return t}},{key:"render",value:function(){return r.a.createElement(v,{menuAction:this.switchTabs,isGoalsReady:this.state.isGoalsReady},"goals"===this.state.tab&&r.a.createElement(O,{selectGoalCard:this.selectGoalCard,selectRandomGoalCard:this.selectRandomGoalCard,state:this.state,switchTabs:this.switchTabs}),"game"===this.state.tab&&"season"===this.state.phase&&r.a.createElement(N,{state:this.state,startSeason:this.startSeason}),"game"===this.state.tab&&"explore"===this.state.phase&&r.a.createElement(G,{state:this.state,nextTurn:this.nextTurn}),"game"===this.state.tab&&"scoring"===this.state.phase&&r.a.createElement(A,{state:this.state,nextTurn:this.setupSeason}))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(D,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[13,1,2]]]);
//# sourceMappingURL=main.5f972e61.chunk.js.map